<!--
  ~ Copyright (c) 2025 vinuth sri arampath
  ~
  ~ This code is the intellectual property of vinuth sri arampath and is protected under copyright law.
  ~ Unauthorized copying, modification, distribution, or use of this code, in whole or in part,
  ~ without prior written permission is strictly prohibited.
  ~
  ~ Portions of this code may be generated with AI and modified by vinuth sri arampath
  ~ All rights reserved.
  -->

<div class="bg-gray-50 text-gray-900 h-screen flex flex-col">
  <header class="bg-blue-900 shadow-lg">
    <div class="container mx-auto px-2 sm:px-4 py-6 flex items-center justify-between">
      <a [routerLink]="['']" routerLinkActive="router-link-active">
        <h1 class="text-white text-2xl sm:text-3xl font-bold">TuitionToAll</h1>
      </a>
    </div>
  </header>

  <div class="flex-1 flex overflow-hidden bg-gray-300/50">
    <div class="flex-1 flex justify-around items-center">
      <div class="w-auto sm:w-lg p-5 sm:p-10 rounded-md shadow-xl drop-shadow-lg bg-white shadow-gray-600">
        <h1 class="text-2xl sm:text-4xl font-bold mb-2">Create Your Account</h1>
        <p class="text-gray-600 mb-4 sm:mb-8">Sign up to join TuitionToAll</p>

        <!-- Progress Indicator -->
        <div class="flex justify-between mb-6">
          <div class="flex-1 text-center">
            <span class="inline-block w-8 h-8 rounded-full border-2" [ngClass]="{'bg-blue-600 text-white border-blue-600': step >= 1, 'border-gray-400 text-gray-400': step < 1}">1</span>
            <p class="text-sm mt-1">User Type</p>
          </div>
          <div class="flex-1 text-center">
            <span class="inline-block w-8 h-8 rounded-full border-2" [ngClass]="{'bg-blue-600 text-white border-blue-600': step >= 2, 'border-gray-400 text-gray-400': step < 2}">2</span>
            <p class="text-sm mt-1">Details</p>
          </div>
          <div class="flex-1 text-center">
            <span class="inline-block w-8 h-8 rounded-full border-2" [ngClass]="{'bg-blue-600 text-white border-blue-600': step >= 3, 'border-gray-400 text-gray-400': step < 3}">3</span>
            <p class="text-sm mt-1">Credentials</p>
          </div>
        </div>

        <!-- Error Message -->
        <div *ngIf="errorMessage" class="w-full text-white bg-red-500 mb-4">
          <div class="container flex items-center justify-between px-6 py-4 mx-auto">
            <div class="flex">
              <svg viewBox="0 0 40 40" class="w-6 h-6 fill-current">
                <path d="M20 3.36667C10.8167 3.36667 3.3667 10.8167 3.3667 20C3.3667 29.1833 10.8167 36.6333 20 36.6333C29.1834 36.6333 36.6334 29.1833 36.6334 20C36.6334 10.8167 29.1834 3.36667 20 3.36667ZM19.1334 33.3333V22.9H13.3334L21.6667 6.66667V17.1H27.25L19.1334 33.3333Z"></path>
              </svg>
              <p class="mx-3">{{errorMessage}}</p>
            </div>
          </div>
        </div>

        <div *ngIf="successMessage" class="w-full text-black bg-green-400 mb-4">
          <div class="container flex items-center justify-between px-6 py-4 mx-auto">
            <div class="flex">
              <svg viewBox="0 0 40 40" class="w-6 h-6 fill-current">
                <path d="M20 3.36667C10.8167 3.36667 3.3667 10.8167 3.3667 20C3.3667 29.1833 10.8167 36.6333 20 36.6333C29.1834 36.6333 36.6334 29.1833 36.6334 20C36.6334 10.8167 29.1834 3.36667 20 3.36667ZM19.1334 33.3333V22.9H13.3334L21.6667 6.66667V17.1H27.25L19.1334 33.3333Z"></path>
              </svg>
              <p class="mx-3">{{successMessage}}</p>
            </div>
          </div>
        </div>

        <form #signupForm="ngForm" (ngSubmit)="nextStep()">
          <!-- Step 1: User Type Selection -->
          <div *ngIf="step === 1">
            <div class="mb-6 flex justify-center items-center gap-3">
              <label class="block text-md text-gray-700 mb-2">I am a:</label>
              <div class="flex flex-col sm:flex-row gap-4">
                <button type="button" (click)="setUserType('student')" [ngClass]="{'bg-blue-600 text-white': userType === 'student', 'bg-gray-200 text-gray-700': userType !== 'student'}" class="px-4 py-2 rounded-md font-semibold focus:outline-none transition-colors duration-300 cursor-pointer">
                  Student
                </button>
                <button type="button" (click)="setUserType('teacher')" [ngClass]="{'bg-blue-600 text-white': userType === 'teacher', 'bg-gray-200 text-gray-700': userType !== 'teacher'}" class="px-4 py-2 rounded-md font-semibold focus:outline-none transition-colors duration-300 cursor-pointer">
                  Teacher
                </button>
                <button type="button" (click)="setUserType('institute')" [ngClass]="{'bg-blue-600 text-white': userType === 'institute', 'bg-gray-200 text-gray-700': userType !== 'institute'}" class="px-4 py-2 rounded-md font-semibold focus:outline-none transition-colors duration-300 cursor-pointer">
                  Institute
                </button>
              </div>
            </div>
          </div>

          <!-- Step 2: Personal/Institute Details -->
          <div *ngIf="step === 2">
            <div *ngIf="userType === 'student' || userType === 'teacher'">
              <div class="relative flex items-center my-2 sm:my-4">
                <span class="absolute">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 mx-3 text-gray-400">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" />
                  </svg>
                </span>
                <input type="text" [(ngModel)]="signupRequest.firstName" name="firstName" placeholder="First Name" class="block w-full py-2.5 text-gray-700 placeholder-gray-400 bg-white border border-gray-400 rounded-lg pl-11 pr-5 focus:border-blue-400 focus:ring-blue-300 focus:outline-none focus:ring focus:ring-opacity-40" required #firstName="ngModel">
              </div>
              <div *ngIf="firstName.invalid && firstName.touched" class="text-red-500 mb-4">First Name is required.</div>

              <div class="relative flex items-center my-2 sm:my-4">
                <span class="absolute">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 mx-3 text-gray-400">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" />
                  </svg>
                </span>
                <input type="text" [(ngModel)]="signupRequest.lastName" name="lastName" placeholder="Last Name" class="block w-full py-2.5 text-gray-700 placeholder-gray-400 bg-white border border-gray-400 rounded-lg pl-11 pr-5 focus:border-blue-400 focus:ring-blue-300 focus:outline-none focus:ring focus:ring-opacity-40" required #lastName="ngModel">
              </div>
              <div *ngIf="lastName.invalid && lastName.touched" class="text-red-500 mb-4">Last Name is required.</div>

              <div class="relative flex items-center my-2 sm:my-4">
                <span class="absolute">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 mx-3 text-gray-400">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5" />
                  </svg>
                </span>
                <input type="date" [(ngModel)]="signupRequest.dateOfBirth" name="dateOfBirth" class="block w-full py-2.5 text-gray-700 placeholder-gray-400 bg-white border border-gray-400 rounded-lg pl-11 pr-5 focus:border-blue-400 focus:ring-blue-300 focus:outline-none focus:ring focus:ring-opacity-40" required #dateOfBirth="ngModel">
              </div>
              <div *ngIf="dateOfBirth.invalid && dateOfBirth.touched" class="text-red-500 mb-4">Date of Birth is required.</div>
            </div>

            <div *ngIf="userType === 'institute'">
              <div class="relative flex items-center my-2 sm:my-4">
                <span class="absolute">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 mx-3 text-gray-400">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 21v-8.25M15.75 21v-8.25M8.25 21v-8.25M3 9l9-6 9 6m-1.5 12V10.332A48.36 48.36 0 0012 9.75c-2.551 0-5.056.2-7.5.582V21M3 21h18M12 6.75h.008v.008H12V6.75Z" />
                  </svg>
                </span>
                <input type="text" [(ngModel)]="signupRequest.instituteName" name="instituteName" placeholder="Institute Name" class="block w-full py-2.5 text-gray-700 placeholder-gray-400 bg-white border border-gray-400 rounded-lg pl-11 pr-5 focus:border-blue-400 focus:ring-blue-300 focus:outline-none focus:ring focus:ring-opacity-40" required #instituteName="ngModel">
              </div>
              <div *ngIf="instituteName.invalid && instituteName.touched" class="text-red-500 mb-4">Institute Name is required.</div>
            </div>

            <div class="relative flex items-center my-2 sm:my-4">
              <span class="absolute">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 mx-3 text-gray-400">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z" />
                  <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z" />
                </svg>
              </span>
              <input type="text" [(ngModel)]="signupRequest.address" name="address" placeholder="Address" class="block w-full py-2.5 text-gray-700 placeholder-gray-400 bg-white border border-gray-400 rounded-lg pl-11 pr-5 focus:border-blue-400 focus:ring-blue-300 focus:outline-none focus:ring focus:ring-opacity-40" required #address="ngModel">
            </div>
            <div *ngIf="address.invalid && address.touched" class="text-red-500 mb-4">Address is required.</div>

            <div class="relative flex items-center my-2 sm:my-4">
              <span class="absolute">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 mx-3 text-gray-400">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 002.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 01-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 00-1.091-.852H4.5A2.25 2.25 0 002.25 4.5v2.25z" />
                </svg>
              </span>
              <input type="tel" [(ngModel)]="signupRequest.contactNo" name="contactNo" placeholder="Contact Number" class="block w-full py-2.5 text-gray-700 placeholder-gray-400 bg-white border border-gray-400 rounded-lg pl-11 pr-5 focus:border-blue-400 focus:ring-blue-300 focus:outline-none focus:ring focus:ring-opacity-40" required pattern="[0-9]{10}" #contactNo="ngModel">
            </div>
            <div *ngIf="contactNo.invalid && contactNo.touched" class="text-red-500 mb-4">
              <div *ngIf="contactNo.errors?.['required']">Contact Number is required.</div>
              <div *ngIf="contactNo.errors?.['pattern']">Please enter a valid 10-digit phone number.</div>
            </div>
          </div>

          <!-- Step 3: Login Credentials -->
          <div *ngIf="step === 3">
            <div class="relative flex items-center my-2 sm:my-4">
              <span class="absolute">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 mx-3 text-gray-400">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75" />
                </svg>
              </span>
              <input type="email" [(ngModel)]="signupRequest.email" name="email" placeholder="john@example.com" class="block w-full py-2.5 text-gray-700 placeholder-gray-400 bg-white border border-gray-400 rounded-lg pl-11 pr-5 focus:border-blue-400 focus:ring-blue-300 focus:outline-none focus:ring focus:ring-opacity-40" required email #email="ngModel">
            </div>
            <div *ngIf="email.invalid && email.touched" class="text-red-500 mb-4">
              <div *ngIf="email.errors?.['required']">Email is required.</div>
              <div *ngIf="email.errors?.['email']">Please enter a valid email address.</div>
            </div>

            <div class="relative flex items-center my-2 sm:my-4">
              <span class="absolute">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 mx-3 text-gray-400">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 5.25a3 3 0 013 3m3 0a6 6 0 01-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1121.75 8.25z" />
                </svg>
              </span>
              <input type="password" [(ngModel)]="signupRequest.password" name="password" placeholder="Password" class="block w-full py-2.5 text-gray-700 placeholder-gray-400 bg-white border border-gray-400 rounded-lg pl-11 pr-5 focus:border-blue-400 focus:ring-blue-300 focus:outline-none focus:ring focus:ring-opacity-40" required minlength="8" #password="ngModel">
            </div>
            <div *ngIf="password.invalid && password.touched" class="text-red-500 mb-4">
              <div *ngIf="password.errors?.['required']">Password is required.</div>
              <div *ngIf="password.errors?.['minlength']">Password must be at least 8 characters long.</div>
            </div>

            <div class="relative flex items-center my-2 sm:my-4">
              <span class="absolute">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 mx-3 text-gray-400">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 5.25a3 3 0 013 3m3 0a6 6 0 01-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1121.75 8.25z" />
                </svg>
              </span>
              <input type="password" [(ngModel)]="confirmPassword" name="confirmPassword" placeholder="Confirm Password" class="block w-full py-2.5 text-gray-700 placeholder-gray-400 bg-white border border-gray-400 rounded-lg pl-11 pr-5 focus:border-blue-400 focus:ring-blue-300 focus:outline-none focus:ring focus:ring-opacity-40" required minlength="8" #cPassword="ngModel">
            </div>
            <div *ngIf="cPassword.invalid && cPassword.touched" class="text-red-500 mb-4">
              <div *ngIf="cPassword.errors?.['required']">Confirm password is required.</div>
              <div *ngIf="cPassword.errors?.['minlength']">Password must be at least 8 characters long.</div>
            </div>
            <div *ngIf="signupRequest.password !== cPassword.value && cPassword.touched" class="text-red-500 mb-4">Passwords do not match.</div>
          </div>

          <!-- Navigation Buttons -->
          <div class="flex justify-between mt-6">
            <button type="button" (click)="prevStep()" *ngIf="step > 1" class="bg-gray-200 text-gray-700 font-semibold rounded-md px-4 py-2 focus:outline-none transition-colors duration-300 w-40 cursor-pointer">
              Previous
            </button>
            <button type="submit" class="bg-blue-600 text-white font-semibold rounded-md px-4 py-2 ml-auto w-40" [ngClass]="{'cursor-not-allowed': signupForm.invalid && step !== 1, 'cursor-pointer': signupForm.valid || step === 1}" [disabled]="signupForm.invalid && step !== 1">
              <span *ngIf="step < 3 && !isLoading">Next</span>
              <span *ngIf="step === 3 && !isLoading">Register</span>
              <span *ngIf="isLoading">Loading...</span>
            </button>
          </div>
        </form>

        <!-- Login Link -->
        <div class="flex items-center gap-2 font-light my-3">
          <span class="flex-1 border-t border-gray-500"></span>
          <span class="text-gray-700">Already have an account?</span>
          <span class="flex-1 border-t border-gray-500"></span>
        </div>
        <a [routerLink]="['/auth/login-dto']" class="text-black border border-black font-semibold rounded-md w-full py-2 text-center block">Login</a>
      </div>
    </div>

    <div class="hidden sm:hidden lg:block flex-1 bg-gray-100">
      <img src="signup-page-team.jpg" alt="Signup Image" class="w-full h-full object-cover">
    </div>
  </div>
</div>
